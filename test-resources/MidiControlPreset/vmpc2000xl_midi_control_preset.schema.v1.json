{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://izmar.nl/vmpc2000xl_midi_control_preset.schema.v1.json",
  "title": "MIDI Control Preset",
  "type": "object",
  "required": ["version", "name", "autoLoad", "bindings"],
  "additionalProperties": false,

  "properties": {
    "version": {
      "type": "integer",
      "minimum": 0,
      "maximum": 4503599627370496,
      "default": 0,
      "description": "Integer between 0 and 2^52 inclusive."
    },

    "name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 16,
      "pattern": "^[A-Za-z0-9 !#\\$%&'\\(\\)\\-@_{}]+$",
      "description": "Preset name: 1 to 16 characters using allowed characters [A-Za-z0-9 !#$%&'()-@_{}]. Required in every preset."
    },
    "midiControllerDeviceName": {
      "type": "string",
      "maxLength": 255,
      "pattern": "^[a-zA-Z0-9 _\\-\\.\\(\\)\\/\\,;]*$",
      "description": "Optional name of the MIDI controller device. Can be empty or up to 255 characters using allowed characters [a-zA-Z0-9 _-./(),;]."
    },
    "autoLoad": {
      "type": "string",
      "enum": ["No", "Ask", "Yes"],
      "default": "No",
      "description": "Controls automatic loading of the preset. 'No': never auto-load. 'Yes': auto-load if a MIDI controller with `midiControllerDeviceName` is connected. 'Ask': prompt the user to load if the controller is connected."
    },
    "bindings": {
      "type": "array",
      "minItems": 81,
      "maxItems": 81,
      "uniqueItems": true,
      "items": { "$ref": "#/$defs/binding" },
      "description": "Array of MIDI control bindings. Must include exactly one binding for each required label name."
    }
  },

  "$defs": {
    "binding": {
      "type": "object",
      "required": [
        "labelName",
        "messageType",
        "midiNumber",
        "midiChannelIndex",
        "enabled"
      ],
      "additionalProperties": false,

      "properties": {
        "labelName": {
          "type": "string",
          "maxLength": 15,
          "pattern": "^[a-z0-9_\\-#]+$",
          "enum": [
            "left","right","up","down","rec","overdub","stop","play","play-start",
            "main-screen","prev-step-event","next-step-event","go-to","prev-bar-start","next-bar-end",
            "tap","next-seq","track-mute","open-window","full-level","sixteen-levels",
            "f1","f2","f3","f4","f5","f6",
            "shift","shift_#1","shift_#2","shift_#3","enter","undo-seq","erase","after",
            "bank-a","bank-b","bank-c","bank-d",
            "0","1","2","3","4","5","6","7","8","9",
            "0_extra","1_extra","2_extra","3_extra","4_extra","5_extra","6_extra","7_extra","8_extra","9_extra",
            "pad-1","pad-2","pad-3","pad-4","pad-5","pad-6","pad-7","pad-8",
            "pad-9","pad-10","pad-11","pad-12","pad-13","pad-14","pad-15","pad-16",
            "datawheel","datawheel-up","datawheel-down","slider","rec-gain","main-volume"
          ]
        },

        "messageType": {
          "type": "string",
          "enum": ["CC", "Note"]
        },

        "midiNumber": {
          "type": "integer",
          "minimum": 0,
          "maximum": 127
        },

        "midiValue": {
          "type": "integer",
          "minimum": -1,
          "maximum": 127
        },

        "midiChannelIndex": {
          "type": "integer",
          "minimum": -1,
          "maximum": 15,
          "description": "Zero-based indexing (0â€“15), or -1 for 'all'."
        },

        "enabled": {
          "type": "boolean"
        }
      },

      "allOf": [
        {
          "if": { "properties": { "messageType": { "const": "CC" } } },
          "then": { "required": ["midiValue"] },
          "else": {
            "not": {
              "required": ["midiValue"]
            }
          }
        }
      ],

      "default": {
        "messageType": "CC",
        "midiNumber": 0,
        "midiValue": 0,
        "midiChannelIndex": 0,
        "enabled": false
      }
    }
  }
}
